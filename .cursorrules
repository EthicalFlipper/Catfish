You are helping build "Catfish" (DateGuard) ‚Äî a Chrome extension that is DATING-APP SPECIFIC.

Current features:
- "Analyze This Thread" on Tinder Web via content script (DOM extraction)
- "Capture Profile" on Tinder Web via captureVisibleTab (screenshot analysis)
- "Record Tab Audio" via tabCapture + offscreen document (voice note analysis)

Hard constraints:
- NO Tinder/Hinge/Bumble API integration. No OAuth. No network interception.
- NO scraping media URLs. Image capture uses ONLY chrome.tabs.captureVisibleTab.
- NO scraping audio URLs. Audio recording uses ONLY tabCapture + offscreen.
- NO model training/fine-tuning. Pretrained + APIs only.
- Keep changes minimal and demo-proof. Avoid unnecessary dependencies.

Content script (Tinder):
- Injects TWO buttons on tinder.com:
  1. "üê± Analyze thread" - extracts chat messages, sends to Text tab
  2. "üì∏ Capture profile" - triggers captureVisibleTab, sends to Image tab
- Uses MutationObserver to survive SPA re-renders
- User-initiated only (button click). No background scraping.

Extension UI:
- Text tab: receives THREAD_IMPORT, auto-fills textarea, analyzes via /analyze/text
- Image tab: receives screenshot from storage, previews, analyzes via /analyze/image
- Audio tab: Record/Stop buttons, records tab audio via offscreen doc, analyzes via /analyze/audio
- All tabs show: scores, flags, explanation, recommended action

Audio recording architecture (MV3-safe):
- Background gets stream ID via chrome.tabCapture.getMediaStreamId()
- Offscreen document uses MediaRecorder to capture audio
- Audio blob sent to backend for transcription + analysis
- Requires ffmpeg on server for audio conversion

Backend (FastAPI):
- POST /analyze/text - AI + scam detection scores, suggested reply
- POST /analyze/image - catfish + AI-generated scores, reverse search steps
- POST /analyze/audio - Whisper transcription + scam/AI voice analysis (requires ffmpeg)
- Strict JSON contracts; clear error messages; CORS for localhost + chrome-extension://*
- Falls back to mock response if OPENAI_API_KEY missing
